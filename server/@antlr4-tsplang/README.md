# ANTLR4-TSPLang

This package exposes:
* classes generated by ANTLR4 from the TSP grammar file.
* types that extend ANTLR4 lexing and parsing functionality.

## Requirements

See [Getting Started with ANTLR v4](https://github.com/antlr/antlr4/blob/master/doc/getting-started.md) for detailed setup instructions.

The following is required to compile the TSP grammar:
* Java Development Kit (v1.6+).
* The antlr complete jar file.
* The environment variable `CLASSPATH`, which should contain two directories:
  * `.` (the currect working directory).
  * The absolute path to the antlr jar file.

## Post-Build Edits

Some files generated by ANTLR4 need to have minor edits applied.

### TspParser

After the last `TspParser.RULE*`, add `namespace TspParser {`. Before `exports.TspParser = TspParser`, add `}`.

The following is a list of Regular Expressions to match a particular portion of code and replace it. VSCode RegEx replacement syntax is used.
* Change Context function declarations to function objects returning a void type.
`^function (.*Context)(\(.*\))`
`const $1 = function$2: void`
<!-- * Comment-out the lines assigning each Context object to the TspParser namespace.
`^(TspParser\.(.*Context) = \2)`
`// $1`
* Tell the TypeScript compiler to ignore Error 2350 ("Only a void function can be called with the 'new' keyword.").
`^(\n(    var localctx = new .*Context))`
`    // @ts-ignore\n$2` -->
